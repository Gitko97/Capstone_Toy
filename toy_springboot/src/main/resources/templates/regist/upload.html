<!DOCTYPE html>
<!-- 타임리프 레이아웃 적용 -->
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

    <head>
        <th:block th:replace="fragments/config :: configFragment"></th:block>
        <title>Toytra Homepage</title>
    </head>

    <body>

        <!-- 사이드바-->
        <th:block th:replace="fragments/sidebar :: sidebarFragment"></th:block>

        <h4 class = "mb-5">등록 페이지</h4>

        <h4 th:text="|현재 샵 id : ${currentShop.shop_id}|"></h4>

        <div class="container" style="margin-top:30px">

            <form method="post" action="" enctype="multipart/form-data" id="fileUploadForm">
                <input type="file" name="file"/>
                <input type="button" id="btnUpload" value = "업로드"/>
            </form>

        </div>

        <!-- Footer-->
        <th:block th:replace="fragments/footer :: footerFragment"></th:block>

    </body>
</html>

<script>

    $("#btnUpload").click(function (event) {

        const form = $('#fileUploadForm')[0];

        const data = new FormData(form);

        $.ajax({
            type: "POST",
            enctype: 'multipart/form-data',
            url: "http://13.125.216.91:8000/finder/api/image_file",
            data: data,
            dataType : "JSON",
            processData: false,
            contentType: false,
            cache: false,
            timeout: 0,
            success: function (data) {
                localStorage.setItem("data", JSON.stringify(data));
                alert("성공");
                location.href="/analysis";
            },
            error: function (e) {
                alert("fail");
            }
        });
    });

</script>





